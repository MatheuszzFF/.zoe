{
  "_metadata": {
    "action_name": "progress-path-corrector",
    "version": "1.0",
    "format": "json",
    "description": "Corre√ß√£o autom√°tica de caminhos de progress para isolamento por projeto",
    "created": "2025-01-20",
    "converted_from": "progress-path-corrector.mdc",
    "ai_optimized": true
  },
  
  "trigger": {
    "patterns": [
      "Detec√ß√£o de uso de caminho progress depreciado",
      "Refer√™ncia a .zoe/rules/progress/",
      "Uso de caminho n√£o isolado por projeto"
    ],
    "automatic": true,
    "priority_level": 2,
    "category": "path-correction",
    "mandatory": true,
    "blocking": false
  },

  "behavior": {
    "description": "Corrige automaticamente caminhos de progress deprecados para novo formato isolado",
    "deprecated_patterns": [
      ".zoe/rules/progress/",
      ".zoe/progress/",
      "progress/ (sem isolamento)"
    ],
    "correct_patterns": [
      ".zoe/rules/context/projects/[projeto]/progress/",
      ".zoe/rules/context/projects/[projeto]/progress/[YYYY-MM-DD]/"
    ],
    "execution_steps": [
      {
        "step": 1,
        "action": "detect_deprecated_path",
        "description": "Detectar uso de caminho progress depreciado",
        "detection_rules": [
          "Qualquer refer√™ncia a .zoe/rules/progress/",
          "Comandos tentando acessar progress sem isolamento",
          "Leitura/escrita em caminhos antigos"
        ]
      },
      {
        "step": 2,
        "action": "identify_active_project",
        "description": "Identificar projeto ativo para corre√ß√£o",
        "source": ".zoe/rules/context/active-project.json",
        "fallback": "Perguntar ao usu√°rio qual projeto"
      },
      {
        "step": 3,
        "action": "migrate_data",
        "description": "Migrar dados existentes se necess√°rio",
        "migration_steps": [
          "Verificar se dados existem no caminho depreciado",
          "Criar estrutura correta se n√£o existir",
          "Copiar dados para caminho correto",
          "Validar migra√ß√£o"
        ]
      },
      {
        "step": 4,
        "action": "update_references",
        "description": "Atualizar todas as refer√™ncias para novo caminho",
        "correction_mapping": {
          ".zoe/rules/progress/": ".zoe/rules/context/projects/[projeto]/progress/",
          ".zoe/progress/": ".zoe/rules/context/projects/[projeto]/progress/",
          "progress/": ".zoe/rules/context/projects/[projeto]/progress/"
        }
      },
      {
        "step": 5,
        "action": "cleanup_deprecated",
        "description": "Limpar caminhos deprecados ap√≥s migra√ß√£o bem-sucedida",
        "safety_checks": [
          "Verificar que migra√ß√£o foi bem-sucedida",
          "Confirmar que dados est√£o no novo local",
          "Fazer backup antes de deletar"
        ]
      }
    ]
  },

  "project_isolation": {
    "description": "Garantir isolamento total por projeto",
    "mandatory_structure": {
      "correct_path": ".zoe/rules/context/projects/[projeto]/progress/[YYYY-MM-DD]/",
      "required_files": [
        "README.md",
        "sessions.log"
      ]
    },
    "forbidden_paths": [
      ".zoe/rules/progress/",
      ".zoe/progress/",
      "Qualquer caminho sem isolamento por projeto"
    ]
  },

  "migration": {
    "description": "Processo de migra√ß√£o de dados antigos",
    "migration_strategy": "Copy and validate, then cleanup",
    "backup_strategy": "Sempre fazer backup antes de deletar",
    "validation": [
      "Verificar integridade dos dados migrados",
      "Confirmar que novo caminho est√° funcional",
      "Testar acesso de leitura/escrita"
    ]
  },

  "integration": {
    "files_read": [
      ".zoe/rules/context/active-project.json",
      ".zoe/rules/progress/ (deprecated)",
      ".zoe/rules/context/projects/[projeto]/progress/"
    ],
    "files_write": [
      ".zoe/rules/context/projects/[projeto]/progress/[data]/",
      "Migration logs"
    ],
    "related_actions": [
      "context-checker",
      "project-creator",
      "context-updater"
    ]
  },

  "validation": {
    "required_conditions": [
      "Projeto ativo identificado",
      "Permiss√µes para criar/mover arquivos",
      "Estrutura de contexto existente"
    ],
    "success_criteria": [
      "Todos os caminhos usando formato correto",
      "Dados migrados com sucesso",
      "Caminhos deprecados limpos",
      "Isolamento por projeto garantido"
    ]
  },

  "error_handling": {
    "common_errors": [
      {
        "error": "migration_failed",
        "description": "Falha na migra√ß√£o de dados",
        "solution": "Restaurar backup e tentar novamente"
      },
      {
        "error": "active_project_not_found",
        "description": "N√£o foi poss√≠vel identificar projeto ativo",
        "solution": "Executar context-checker primeiro"
      },
      {
        "error": "permission_denied",
        "description": "Sem permiss√£o para mover/criar arquivos",
        "solution": "Verificar permiss√µes do sistema de arquivos"
      },
      {
        "error": "data_corruption",
        "description": "Dados corrompidos durante migra√ß√£o",
        "solution": "Restaurar backup e investigar causa"
      }
    ]
  },

  "objective": {
    "primary": "Garantir isolamento perfeito por projeto",
    "benefits": [
      "Evitar conflitos entre projetos",
      "Melhor organiza√ß√£o de dados",
      "Facilitar backup/restore por projeto",
      "Suporte a m√∫ltiplos projetos simult√¢neos"
    ]
  },

  "logging": {
    "log_format": "üîÑ PATH CORRECTOR:\n- Caminho depreciado: [old_path]\n- Caminho correto: [new_path]\n- Projeto: [projeto]\n- A√ß√£o: [migrated | corrected | cleaned]\n- Status: [success | failed]",
    "log_location": ".zoe/rules/logs/path-corrections.log"
  }
} 