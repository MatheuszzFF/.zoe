{
  "_metadata": {
    "command_name": "zoe-start",
    "version": "2.1",
    "format": "json",
    "description": "Comando inteligente de inicializa√ß√£o com context memory, isolamento por projeto e leitura de progresso hist√≥rico",
    "created": "2025-06-09",
    "updated": "2025-06-10",
    "ai_optimized": true
  },
  
  "trigger": {
    "patterns": [
      "zoe iniciar",
      "zoe, iniciar", 
      "zoe iniciar [nome-do-projeto]",
      "zoe iniciar [nome-do-projeto] [data]"
    ],
    "requirements": [
      "Deve executar AP√ìS action context-checker (level 0)",
      "Context-checker deve retornar status CONTEXT_READY"
    ],
    "priority_level": 3,
    "category": "initialization",
    "RESTRICTIONS": {
      "NEVER_DO": [
        "run_terminal_cmd",
        "execute npm commands",
        "check node_modules",
        "validate dependencies",
        "run prisma commands",
        "verify environment setup",
        "install packages",
        "check system status"
      ],
      "ONLY_DO": [
        "read/write context files",
        "show project summary",
        "suggest next actions",
        "update progress files",
        "read historical progress files"
      ]
    }
  },

  "date_handling": {
    "description": "NOVA FUNCIONALIDADE: Gest√£o inteligente de datas",
    "rules": [
      {
        "condition": "data n√£o especificada pelo usu√°rio",
        "action": "ask_for_date",
        "message": "üìÖ **Data necess√°ria:** Qual data voc√™ quer usar para esta sess√£o? (formato: DD-MM ou YYYY-MM-DD)",
        "validation": [
          "Aceitar formato DD-MM (assumir ano atual)",
          "Aceitar formato YYYY-MM-DD",
          "Validar se data √© v√°lida",
          "Converter para formato YYYY-MM-DD interno"
        ]
      },
      {
        "condition": "data especificada",
        "action": "use_specified_date",
        "format_conversion": {
          "input_formats": ["DD-MM", "YYYY-MM-DD"],
          "output_format": "YYYY-MM-DD",
          "current_year_assumption": true
        }
      }
    ]
  },

  "prerequisites": {
    "description": "Este comando s√≥ executa ap√≥s verifica√ß√µes de contexto",
    "dependencies": [
      {
        "action": "context-checker",
        "level": 0,
        "status_required": "CONTEXT_READY",
        "validations": [
          "Contexto atual verificado",
          "Mudan√ßas de projeto detectadas/aplicadas",
          "Set project autom√°tico executado (se necess√°rio)",
          "Projeto novo criado (se necess√°rio via project-creator)"
        ]
      }
    ]
  },

  "behavior": {
    "phases": [
      {
        "phase": 1,
        "name": "load_active_context",
        "description": "Carregamento do contexto ativo (SOMENTE ARQUIVOS, SEM TERMINAL)",
        "forbidden_actions": [
          "run_terminal_cmd",
          "execute_commands",
          "check_npm",
          "validate_dependencies",
          "verify_environment"
        ],
        "steps": [
          {
            "step": 1,
            "action": "read_active_project",
            "file": ".zoe/rules/context/active-project.json",
            "extract": "active_project"
          },
          {
            "step": 2,
            "action": "read_project_context", 
            "file": ".zoe/rules/context/projects/[active_project]/project-context.json",
            "extract": ["tech_stack", "project_overview", "current_context"]
          },
          {
            "step": 3,
            "action": "check_today_progress",
            "file": ".zoe/rules/context/projects/[active_project]/progress/[YYYY-MM-DD]/README.md",
            "create_if_missing": true,
            "template": ".zoe/rules/context/daily-progress-template.md",
            "NOVA_FUNCIONALIDADE": {
              "when_missing": "read_last_available_progress",
              "description": "Se arquivo do dia n√£o existir, ler √∫ltimo progresso dispon√≠vel para se situar",
              "fallback_strategy": {
                "step_1": "Listar arquivos de progress do projeto",
                "step_2": "Identificar √∫ltima data dispon√≠vel",
                "step_3": "Ler √∫ltimo arquivo para entender onde parou",
                "step_4": "Incluir resumo do √∫ltimo progresso na inicializa√ß√£o",
                "step_5": "Criar novo arquivo do dia com refer√™ncia ao contexto anterior"
              }
            }
          }
        ]
      },
      {
        "phase": 1.5,
        "name": "historical_context_recovery",
        "description": "NOVA FASE: Recupera√ß√£o de contexto hist√≥rico quando necess√°rio",
        "when_to_execute": "Quando arquivo de progresso do dia n√£o existir",
        "steps": [
          {
            "step": 1,
            "action": "find_last_progress",
            "method": "list_progress_directory",
            "path": ".zoe/rules/context/projects/[active_project]/progress/",
            "sort": "descending_date"
          },
          {
            "step": 2,
            "action": "read_last_progress",
            "file": "[last_progress_file_found]",
            "extract": [
              "√öltima atividade realizada",
              "Status dos componentes",
              "Pr√≥ximas a√ß√µes planejadas",
              "Bloqueadores pendentes",
              "Decis√µes tomadas"
            ]
          },
          {
            "step": 3,
            "action": "summarize_gap",
            "description": "Resumir o que aconteceu desde a √∫ltima sess√£o",
            "output_format": "üìÖ **√öltima sess√£o:** [data] - [resumo_atividades]\nüéØ **Onde paramos:** [√∫ltima_atividade]\nüìã **Pend√™ncias:** [lista_pendencias]"
          }
        ]
      },
      {
        "phase": 2,
        "name": "intelligent_summary",
        "description": "Mostrar resumo inteligente do estado atual (ATUALIZADO com contexto hist√≥rico)",
        "output_templates": {
          "existing_context_with_history": {
            "format": "üìç **Localiza√ß√£o Zoe:** Projeto '[project_name]' (contexto desde [creation_date])\nüìä **Stack conhecida:** [tech_stack_summary]\nüéØ **Objetivo atual:** [project_objectives]\nüìÖ **√öltima sess√£o:** [last_session_date] - [last_session_summary]\nüîÑ **Onde paramos:** [last_activity]\nüìà **Progresso hoje:** [today_activities_summary]",
            "variables": {
              "project_name": "project_overview.name",
              "creation_date": "_metadata.created", 
              "tech_stack_summary": "tech_stack.frontend.framework + tech_stack.frontend.language",
              "project_objectives": "project_overview.objectives[0]",
              "last_session_date": "[extracted_from_last_progress]",
              "last_session_summary": "[extracted_from_last_progress]",
              "last_activity": "[extracted_from_last_progress]",
              "today_activities_summary": "current_context.active_work"
            }
          },
          "existing_context": {
            "format": "üìç **Localiza√ß√£o Zoe:** Projeto '[project_name]' (contexto existente desde [creation_date])\nüìä **Stack conhecida:** [tech_stack_summary]\nüéØ **Objetivo atual:** [project_objectives]\nüìà **Progresso hoje:** [today_activities_summary]",
            "variables": {
              "project_name": "project_overview.name",
              "creation_date": "_metadata.created", 
              "tech_stack_summary": "tech_stack.frontend.framework + tech_stack.frontend.language",
              "project_objectives": "project_overview.objectives[0]",
              "today_activities_summary": "current_context.active_work"
            }
          },
          "new_context": {
            "format": "üÜï **Localiza√ß√£o Zoe:** Novo projeto '[project_name]' configurado\nüîß **Stack detectada/configurada:** [tech_stack_summary]\nüéØ **Objetivo definido:** [project_objectives]\nüìÖ **Progresso iniciado:** Estrutura criada para hoje",
            "variables": {
              "project_name": "project_overview.name",
              "tech_stack_summary": "tech_stack.frontend.framework + tech_stack.frontend.language",
              "project_objectives": "project_overview.objectives[0]"
            }
          }
        }
      },
      {
        "phase": 3,
        "name": "update_daily_progress",
        "description": "Atualizar progresso di√°rio do projeto (ATUALIZADO com contexto hist√≥rico)",
        "file_path": ".zoe/rules/context/projects/[active_project]/progress/[YYYY-MM-DD]/README.md",
        "template_structure": {
          "header": "# Progresso - [project_name] - [date]",
          "sections": [
            {
              "name": "localization",
              "title": "üéØ Localiza√ß√£o Zoe",
              "content": [
                "Como me localizei: [localization_method]",
                "Projeto: [project_name]", 
                "Stack: [stack_summary]",
                "Sess√£o iniciada: [timestamp]",
                "NOVA_LINHA: √öltima sess√£o: [last_session_context_if_available]"
              ]
            },
            {
              "name": "daily_tasks",
              "title": "üìã Tarefas do Dia",
              "content": "- [ ] [baseadas no contexto, √∫ltimo progresso ou objetivos definidos]"
            },
            {
              "name": "activities",
              "title": "üîÑ Atividades Realizadas", 
              "content": "[Ser√° preenchido durante o dia]"
            },
            {
              "name": "decisions",
              "title": "üìù Decis√µes Tomadas",
              "content": "[Ser√° preenchido durante o dia]"
            },
            {
              "name": "next_actions",
              "title": "üöÄ Pr√≥ximas A√ß√µes",
              "content": "[Baseado no √∫ltimo progresso ou ser√° preenchido durante o dia]"
            }
          ]
        }
      },
      {
        "phase": 4,
        "name": "suggest_next_actions",
        "description": "Sugerir pr√≥ximas a√ß√µes baseadas no contexto (SOMENTE SUGEST√ïES, SEM EXECU√á√ÉO) - ATUALIZADO com contexto hist√≥rico",
        "forbidden_actions": [
          "auto_execute_suggestions",
          "run_terminal_cmd",
          "execute_commands",
          "validate_environment"
        ],
        "note": "APENAS apresentar sugest√µes, NUNCA executar comandos automaticamente",
        "logic": [
          {
            "condition": "last_progress_available && pending_tasks_found",
            "suggestion": "Continuar tarefas da √∫ltima sess√£o: [list_pending_from_last_session]"
          },
          {
            "condition": "last_progress_available && next_actions_found",
            "suggestion": "Implementar pr√≥ximas a√ß√µes planejadas: [list_next_actions_from_last_session]"
          },
          {
            "condition": "components_created.length === 0",
            "suggestion": "Criar primeiro componente baseado no objetivo do projeto"
          },
          {
            "condition": "current_context.pending_tasks.length > 0",
            "suggestion": "Continuar tarefas pendentes: [list_pending_tasks]"
          },
          {
            "condition": "current_context.blockers.length > 0", 
            "suggestion": "Resolver bloqueadores: [list_blockers]"
          },
          {
            "condition": "default",
            "suggestion": "next_suggested actions from context"
          }
        ]
      }
    ]
  },

  "project_isolation": {
    "description": "Manter separa√ß√£o total entre projetos",
    "mandatory_paths": {
      "logs": ".zoe/rules/context/projects/[project_name]/logs/",
      "progress": ".zoe/rules/context/projects/[project_name]/progress/",
      "context": ".zoe/rules/context/projects/[project_name]/project-context.json"
    },
    "forbidden_paths": [
      ".zoe/rules/progress/",
      ".zoe/rules/context/project-memory.json"
    ],
    "rules": [
      "NUNCA misturar informa√ß√µes entre projetos diferentes",
      "SEMPRE usar caminho espec√≠fico do projeto ativo",
      "CRIAR estrutura automaticamente se n√£o existir"
    ]
  },

  "autodetection": {
    "description": "Detec√ß√£o autom√°tica de stack tecnol√≥gica",
    "detection_files": {
      "package.json": ["Node.js", "React", "Next.js", "TypeScript"],
      "composer.json": ["PHP", "Laravel"], 
      "requirements.txt": ["Python", "Django"],
      "Gemfile": ["Ruby", "Rails"],
      "cargo.toml": ["Rust"]
    },
    "fallback_questions": [
      {
        "question": "üîß **Stack Tecnol√≥gica:** N√£o detectei automaticamente. Qual stack voc√™ est√° usando?",
        "type": "tech_stack"
      },
      {
        "question": "üéØ **Objetivo do Projeto:** Qual o objetivo principal deste projeto?", 
        "type": "project_objective"
      },
      {
        "question": "‚öôÔ∏è **Prefer√™ncias:** Alguma prefer√™ncia espec√≠fica de arquitetura ou padr√µes?",
        "type": "preferences"
      }
    ]
  },

  "examples": {
    "existing_project_with_history": {
      "input": "zoe iniciar loja-virtual",
      "context_state": "project exists, no progress today, last progress available",
      "expected_output": "üìç **Contexto encontrado:** Projeto 'loja-virtual' localizado e carregado\nüìä **Stack:** Next.js 14, TypeScript, Tailwind, Prisma\nüéØ **Objetivo:** E-commerce completo com admin\nüìÖ **√öltima sess√£o:** 08-06-2025 - Componente ProductCard criado\nüîÑ **Onde paramos:** Testes do ProductCard finalizados\nüìã **Pend√™ncias:** ProductList e implementar carrinho\nüöÄ **Sugest√£o:** Continuar com ProductList conforme planejado na √∫ltima sess√£o?"
    },
    "existing_project": {
      "input": "zoe iniciar loja-virtual",
      "context_state": "project exists, progress today available",
      "expected_output": "üìç **Contexto encontrado:** Projeto 'loja-virtual' localizado e carregado\nüìä **Stack:** Next.js 14, TypeScript, Tailwind, Prisma\nüéØ **Objetivo:** E-commerce completo com admin\nüìà **Progresso hoje:** ProductCard em desenvolvimento\nüöÄ **Sugest√£o:** Continuar com ProductList ou implementar carrinho?"
    },
    "new_project": {
      "input": "zoe iniciar blog-pessoal",
      "context_state": "project does not exist",
      "expected_output": "üîç **Autodetec√ß√£o:** package.json detectado - Next.js + TypeScript\nüÜï **Novo projeto:** 'blog-pessoal' configurado\nüéØ **Objetivo necess√°rio:** Qual objetivo deste blog?\n[Ap√≥s resposta do usu√°rio]\n‚úÖ **Contexto criado:** Pronto para come√ßar!"
    },
    "no_project_specified": {
      "input": "zoe iniciar",
      "context_state": "no project name",
      "expected_output": "‚ùì **Nome do projeto n√£o especificado**\nüìç **Projeto atual:** [projeto-ativo-atual]\nüìã **Projetos dispon√≠veis:** [lista]\nüí° **Para mudar projeto:** zoe iniciar [nome-do-projeto]\nüí° **Para criar novo:** zoe iniciar [nome-novo-projeto]"
    },
    "date_not_specified": {
      "input": "zoe iniciar loja-virtual",
      "context_state": "project exists, but user didn't specify date",
      "expected_output": "üìÖ **Data necess√°ria:** Qual data voc√™ quer usar para esta sess√£o? (formato: DD-MM ou YYYY-MM-DD)\nüí° **Exemplo:** 10-06 ou 2025-06-10"
    },
    "with_date_specified": {
      "input": "zoe iniciar loja-virtual 08-06",
      "context_state": "project exists, date specified",
      "expected_output": "üìç **Contexto encontrado:** Projeto 'loja-virtual' para 08-06-2025\nüìä **Stack:** Next.js 14, TypeScript, Tailwind, Prisma\nüéØ **Objetivo:** E-commerce completo com admin\nüìÖ **Progresso 08-06:** [carregar/criar arquivo espec√≠fico da data]\nüöÄ **Pronto para trabalhar na data especificada!**"
    }
  },

  "integration": {
    "related_actions": [
      "context-checker (level 0)",
      "project-creator (level 1)",
      "stack-autodetection (level 24)"
    ],
    "updates_files": [
      ".zoe/rules/context/projects/[active_project]/progress/[YYYY-MM-DD]/README.md"
    ],
    "reads_files": [
      ".zoe/rules/context/active-project.json",
      ".zoe/rules/context/projects/[active_project]/project-context.json",
      ".zoe/rules/context/projects/[active_project]/progress/[last_available_date]/README.md"
    ]
  },

  "error_handling": {
    "missing_project_context": {
      "action": "trigger project-creator",
      "message": "‚ùå **Contexto de projeto n√£o encontrado**\nüîß **Criando automaticamente...**"
    },
    "invalid_project_name": {
      "action": "show validation error",
      "message": "‚ùå **Nome de projeto inv√°lido**\n‚úÖ **Use:** letras, n√∫meros, h√≠fens apenas"
    },
    "invalid_date_format": {
      "action": "show validation error",
      "message": "‚ùå **Formato de data inv√°lido**\n‚úÖ **Use:** DD-MM ou YYYY-MM-DD\nüí° **Exemplo:** 10-06 ou 2025-06-10"
    },
    "permission_error": {
      "action": "show permission error",
      "message": "‚ùå **Erro de permiss√£o ao acessar projeto**\nüîç **Verificar:** permiss√µes da pasta .zoe/"
    },
    "no_historical_progress": {
      "action": "continue without history",
      "message": "‚ÑπÔ∏è **Nenhum progresso hist√≥rico encontrado**\nüÜï **Iniciando nova sess√£o sem contexto anterior**"
    }
  }
} 