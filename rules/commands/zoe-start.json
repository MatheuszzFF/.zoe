{
  "_metadata": {
    "command_name": "zoe-start",
    "version": "2.1",
    "format": "json",
    "description": "Comando inteligente de inicializaÃ§Ã£o com context memory, isolamento por projeto e leitura de progresso histÃ³rico",
    "created": "2025-06-09",
    "updated": "2025-06-10",
    "ai_optimized": true
  },
  
  "trigger": {
    "patterns": [
      "zoe iniciar",
      "zoe, iniciar", 
      "zoe iniciar [nome-do-projeto]",
      "zoe iniciar [nome-do-projeto] [data]"
    ],
    "requirements": [
      "Deve executar APÃ“S action context-checker (level 0)",
      "Context-checker deve retornar status CONTEXT_READY"
    ],
    "priority_level": 3,
    "category": "initialization",
    "RESTRICTIONS": {
      "NEVER_DO": [
        "run_terminal_cmd",
        "execute npm commands",
        "check node_modules",
        "validate dependencies",
        "run prisma commands",
        "verify environment setup",
        "install packages",
        "check system status"
      ],
      "ONLY_DO": [
        "read/write context files",
        "show project summary",
        "suggest next actions",
        "update progress files",
        "read historical progress files"
      ]
    }
  },

  "date_handling": {
    "description": "NOVA FUNCIONALIDADE: GestÃ£o inteligente de datas",
    "rules": [
      {
        "condition": "data nÃ£o especificada pelo usuÃ¡rio",
        "action": "ask_for_date",
        "message": "ğŸ“… **Data necessÃ¡ria:** Qual data vocÃª quer usar para esta sessÃ£o? (formato: DD-MM ou YYYY-MM-DD)",
        "validation": [
          "Aceitar formato DD-MM (assumir ano atual)",
          "Aceitar formato YYYY-MM-DD",
          "Validar se data Ã© vÃ¡lida",
          "Converter para formato YYYY-MM-DD interno"
        ]
      },
      {
        "condition": "data especificada",
        "action": "use_specified_date",
        "format_conversion": {
          "input_formats": ["DD-MM", "YYYY-MM-DD"],
          "output_format": "YYYY-MM-DD",
          "current_year_assumption": true
        }
      }
    ]
  },

  "prerequisites": {
    "description": "Este comando sÃ³ executa apÃ³s verificaÃ§Ãµes de contexto",
    "dependencies": [
      {
        "action": "context-checker",
        "level": 0,
        "status_required": "CONTEXT_READY",
        "validations": [
          "Contexto atual verificado",
          "MudanÃ§as de projeto detectadas/aplicadas",
          "Set project automÃ¡tico executado (se necessÃ¡rio)",
          "Projeto novo criado (se necessÃ¡rio via project-creator)"
        ]
      }
    ]
  },

  "behavior": {
    "phases": [
      {
        "phase": 1,
        "name": "load_active_context",
        "description": "Carregamento do contexto ativo (SOMENTE ARQUIVOS, SEM TERMINAL)",
        "forbidden_actions": [
          "run_terminal_cmd",
          "execute_commands",
          "check_npm",
          "validate_dependencies",
          "verify_environment"
        ],
        "steps": [
          {
            "step": 1,
            "action": "read_active_project",
            "file": ".zoe/rules/context/active-project.json",
            "extract": "active_project"
          },
          {
            "step": 2,
            "action": "read_project_context", 
            "file": ".zoe/rules/context/projects/[active_project]/project-context.json",
            "extract": ["tech_stack", "project_overview", "current_context"]
          },
          {
            "step": 3,
            "action": "check_today_progress",
            "file": ".zoe/rules/context/projects/[active_project]/progress/[YYYY-MM-DD]/README.md",
            "create_if_missing": true,
            "template": ".zoe/rules/context/daily-progress-template.md",
            "NOVA_FUNCIONALIDADE": {
              "when_missing": "read_last_available_progress",
              "description": "Se arquivo do dia nÃ£o existir, ler Ãºltimo progresso disponÃ­vel para se situar",
              "fallback_strategy": {
                "step_1": "Listar arquivos de progress do projeto",
                "step_2": "Identificar Ãºltima data disponÃ­vel",
                "step_3": "Ler Ãºltimo arquivo para entender onde parou",
                "step_4": "Incluir resumo do Ãºltimo progresso na inicializaÃ§Ã£o",
                "step_5": "Criar novo arquivo do dia com referÃªncia ao contexto anterior"
              }
            }
          }
        ]
      },
      {
        "phase": 1.5,
        "name": "historical_context_recovery",
        "description": "NOVA FASE: RecuperaÃ§Ã£o de contexto histÃ³rico quando necessÃ¡rio",
        "when_to_execute": "Quando arquivo de progresso do dia nÃ£o existir",
        "steps": [
          {
            "step": 1,
            "action": "find_last_progress",
            "method": "list_progress_directory",
            "path": ".zoe/rules/context/projects/[active_project]/progress/",
            "sort": "descending_date"
          },
          {
            "step": 2,
            "action": "read_last_progress",
            "file": "[last_progress_file_found]",
            "extract": [
              "Ãšltima atividade realizada",
              "Status dos componentes",
              "PrÃ³ximas aÃ§Ãµes planejadas",
              "Bloqueadores pendentes",
              "DecisÃµes tomadas"
            ]
          },
          {
            "step": 3,
            "action": "summarize_gap",
            "description": "Resumir o que aconteceu desde a Ãºltima sessÃ£o",
            "output_format": "ğŸ“… **Ãšltima sessÃ£o:** [data] - [resumo_atividades]\nğŸ¯ **Onde paramos:** [Ãºltima_atividade]\nğŸ“‹ **PendÃªncias:** [lista_pendencias]"
          }
        ]
      },
      {
        "phase": 2,
        "name": "intelligent_summary",
        "description": "Mostrar resumo inteligente do estado atual (ATUALIZADO com contexto histÃ³rico)",
        "output_templates": {
          "existing_context_with_history": {
            "format": "ğŸ“ **LocalizaÃ§Ã£o Zoe:** Projeto '[project_name]' (contexto desde [creation_date])\nğŸ“Š **Stack conhecida:** [tech_stack_summary]\nğŸ¯ **Objetivo atual:** [project_objectives]\nğŸ“… **Ãšltima sessÃ£o:** [last_session_date] - [last_session_summary]\nğŸ”„ **Onde paramos:** [last_activity]\nğŸ“ˆ **Progresso hoje:** [today_activities_summary]",
            "variables": {
              "project_name": "project_overview.name",
              "creation_date": "_metadata.created", 
              "tech_stack_summary": "tech_stack.frontend.framework + tech_stack.frontend.language",
              "project_objectives": "project_overview.objectives[0]",
              "last_session_date": "[extracted_from_last_progress]",
              "last_session_summary": "[extracted_from_last_progress]",
              "last_activity": "[extracted_from_last_progress]",
              "today_activities_summary": "current_context.active_work"
            }
          },
          "existing_context": {
            "format": "ğŸ“ **LocalizaÃ§Ã£o Zoe:** Projeto '[project_name]' (contexto existente desde [creation_date])\nğŸ“Š **Stack conhecida:** [tech_stack_summary]\nğŸ¯ **Objetivo atual:** [project_objectives]\nğŸ“ˆ **Progresso hoje:** [today_activities_summary]",
            "variables": {
              "project_name": "project_overview.name",
              "creation_date": "_metadata.created", 
              "tech_stack_summary": "tech_stack.frontend.framework + tech_stack.frontend.language",
              "project_objectives": "project_overview.objectives[0]",
              "today_activities_summary": "current_context.active_work"
            }
          },
          "new_context": {
            "format": "ğŸ†• **LocalizaÃ§Ã£o Zoe:** Novo projeto '[project_name]' configurado\nğŸ”§ **Stack detectada/configurada:** [tech_stack_summary]\nğŸ¯ **Objetivo definido:** [project_objectives]\nğŸ“… **Progresso iniciado:** Estrutura criada para hoje",
            "variables": {
              "project_name": "project_overview.name",
              "tech_stack_summary": "tech_stack.frontend.framework + tech_stack.frontend.language",
              "project_objectives": "project_overview.objectives[0]"
            }
          }
        }
      },
      {
        "phase": 3,
        "name": "update_daily_progress",
        "description": "Atualizar progresso diÃ¡rio do projeto (ATUALIZADO com contexto histÃ³rico)",
        "file_path": ".zoe/rules/context/projects/[active_project]/progress/[YYYY-MM-DD]/README.md",
        "template_structure": {
          "header": "# Progresso - [project_name] - [date]",
          "sections": [
            {
              "name": "localization",
              "title": "ğŸ¯ LocalizaÃ§Ã£o Zoe",
              "content": [
                "Como me localizei: [localization_method]",
                "Projeto: [project_name]", 
                "Stack: [stack_summary]",
                "SessÃ£o iniciada: [timestamp]",
                "NOVA_LINHA: Ãšltima sessÃ£o: [last_session_context_if_available]"
              ]
            },
            {
              "name": "daily_tasks",
              "title": "ğŸ“‹ Tarefas do Dia",
              "content": "- [ ] [baseadas no contexto, Ãºltimo progresso ou objetivos definidos]"
            },
            {
              "name": "activities",
              "title": "ğŸ”„ Atividades Realizadas", 
              "content": "[SerÃ¡ preenchido durante o dia]"
            },
            {
              "name": "decisions",
              "title": "ğŸ“ DecisÃµes Tomadas",
              "content": "[SerÃ¡ preenchido durante o dia]"
            },
            {
              "name": "next_actions",
              "title": "ğŸš€ PrÃ³ximas AÃ§Ãµes",
              "content": "[Baseado no Ãºltimo progresso ou serÃ¡ preenchido durante o dia]"
            }
          ]
        }
      },
      {
        "phase": 4,
        "name": "suggest_next_actions",
        "description": "Sugerir prÃ³ximas aÃ§Ãµes baseadas no contexto (SOMENTE SUGESTÃ•ES, SEM EXECUÃ‡ÃƒO) - ATUALIZADO com contexto histÃ³rico",
        "forbidden_actions": [
          "auto_execute_suggestions",
          "run_terminal_cmd",
          "execute_commands",
          "validate_environment"
        ],
        "note": "APENAS apresentar sugestÃµes, NUNCA executar comandos automaticamente",
        "logic": [
          {
            "condition": "last_progress_available && pending_tasks_found",
            "suggestion": "Continuar tarefas da Ãºltima sessÃ£o: [list_pending_from_last_session]"
          },
          {
            "condition": "last_progress_available && next_actions_found",
            "suggestion": "Implementar prÃ³ximas aÃ§Ãµes planejadas: [list_next_actions_from_last_session]"
          },
          {
            "condition": "components_created.length === 0",
            "suggestion": "Criar primeiro componente baseado no objetivo do projeto"
          },
          {
            "condition": "current_context.pending_tasks.length > 0",
            "suggestion": "Continuar tarefas pendentes: [list_pending_tasks]"
          },
          {
            "condition": "current_context.blockers.length > 0", 
            "suggestion": "Resolver bloqueadores: [list_blockers]"
          },
          {
            "condition": "default",
            "suggestion": "next_suggested actions from context"
          }
        ]
      }
    ]
  },

  "project_isolation": {
    "description": "Manter separaÃ§Ã£o total entre projetos",
    "mandatory_paths": {
      "logs": ".zoe/rules/context/projects/[project_name]/logs/",
      "progress": ".zoe/rules/context/projects/[project_name]/progress/",
      "context": ".zoe/rules/context/projects/[project_name]/project-context.json"
    },
    "forbidden_paths": [
      ".zoe/rules/progress/",
      ".zoe/rules/context/project-memory.json"
    ],
    "rules": [
      "NUNCA misturar informaÃ§Ãµes entre projetos diferentes",
      "SEMPRE usar caminho especÃ­fico do projeto ativo",
      "CRIAR estrutura automaticamente se nÃ£o existir"
    ]
  },

  "autodetection": {
    "description": "DetecÃ§Ã£o automÃ¡tica de stack tecnolÃ³gica",
    "detection_files": {
      "package.json": ["Node.js", "React", "Next.js", "TypeScript"],
      "composer.json": ["PHP", "Laravel"], 
      "requirements.txt": ["Python", "Django"],
      "Gemfile": ["Ruby", "Rails"],
      "cargo.toml": ["Rust"]
    },
    "fallback_questions": [
      {
        "question": "ğŸ”§ **Stack TecnolÃ³gica:** NÃ£o detectei automaticamente. Qual stack vocÃª estÃ¡ usando?",
        "type": "tech_stack"
      },
      {
        "question": "ğŸ¯ **Objetivo do Projeto:** Qual o objetivo principal deste projeto?", 
        "type": "project_objective"
      },
      {
        "question": "âš™ï¸ **PreferÃªncias:** Alguma preferÃªncia especÃ­fica de arquitetura ou padrÃµes?",
        "type": "preferences"
      }
    ]
  },

  "examples": {
    "existing_project_with_history": {
      "input": "zoe iniciar loja-virtual",
      "context_state": "project exists, no progress today, last progress available",
      "expected_output": "ğŸ“ **Contexto encontrado:** Projeto 'loja-virtual' localizado e carregado\nğŸ“Š **Stack:** Next.js 14, TypeScript, Tailwind, Prisma\nğŸ¯ **Objetivo:** E-commerce completo com admin\nğŸ“… **Ãšltima sessÃ£o:** 08-06-2025 - Componente ProductCard criado\nğŸ”„ **Onde paramos:** Testes do ProductCard finalizados\nğŸ“‹ **PendÃªncias:** ProductList e implementar carrinho\nğŸš€ **SugestÃ£o:** Continuar com ProductList conforme planejado na Ãºltima sessÃ£o?"
    },
    "existing_project": {
      "input": "zoe iniciar loja-virtual",
      "context_state": "project exists, progress today available",
      "expected_output": "ğŸ“ **Contexto encontrado:** Projeto 'loja-virtual' localizado e carregado\nğŸ“Š **Stack:** Next.js 14, TypeScript, Tailwind, Prisma\nğŸ¯ **Objetivo:** E-commerce completo com admin\nğŸ“ˆ **Progresso hoje:** ProductCard em desenvolvimento\nğŸš€ **SugestÃ£o:** Continuar com ProductList ou implementar carrinho?"
    },
    "new_project": {
      "input": "zoe iniciar blog-pessoal",
      "context_state": "project does not exist",
      "expected_output": "ğŸ” **AutodetecÃ§Ã£o:** package.json detectado - Next.js + TypeScript\nğŸ†• **Novo projeto:** 'blog-pessoal' configurado\nğŸ¯ **Objetivo necessÃ¡rio:** Qual objetivo deste blog?\n[ApÃ³s resposta do usuÃ¡rio]\nâœ… **Contexto criado:** Pronto para comeÃ§ar!"
    },
    "no_project_specified": {
      "input": "zoe iniciar",
      "context_state": "no project name",
      "expected_output": "â“ **Nome do projeto nÃ£o especificado**\nğŸ“ **Projeto atual:** [projeto-ativo-atual]\nğŸ“‹ **Projetos disponÃ­veis:** [lista]\nğŸ’¡ **Para mudar projeto:** zoe iniciar [nome-do-projeto]\nğŸ’¡ **Para criar novo:** zoe iniciar [nome-novo-projeto]"
    },
    "date_not_specified": {
      "input": "zoe iniciar loja-virtual",
      "context_state": "project exists, but user didn't specify date",
      "expected_output": "ğŸ“… **Data necessÃ¡ria:** Qual data vocÃª quer usar para esta sessÃ£o? (formato: DD-MM ou YYYY-MM-DD)\nğŸ’¡ **Exemplo:** 10-06 ou 2025-06-10"
    },
    "with_date_specified": {
      "input": "zoe iniciar loja-virtual 08-06",
      "context_state": "project exists, date specified",
      "expected_output": "ğŸ“ **Contexto encontrado:** Projeto 'loja-virtual' para 08-06-2025\nğŸ“Š **Stack:** Next.js 14, TypeScript, Tailwind, Prisma\nğŸ¯ **Objetivo:** E-commerce completo com admin\nğŸ“… **Progresso 08-06:** [carregar/criar arquivo especÃ­fico da data]\nğŸš€ **Pronto para trabalhar na data especificada!**"
    }
  },

  "integration": {
    "related_actions": [
      "context-checker (level 0)",
      "project-creator (level 1)",
      "stack-autodetection (level 24)"
    ],
    "updates_files": [
      ".zoe/rules/context/projects/[active_project]/progress/[YYYY-MM-DD]/README.md"
    ],
    "reads_files": [
      ".zoe/rules/context/active-project.json",
      ".zoe/rules/context/projects/[active_project]/project-context.json",
      ".zoe/rules/context/projects/[active_project]/progress/[last_available_date]/README.md"
    ]
  },

  "error_handling": {
    "missing_project_context": {
      "action": "trigger project-creator",
      "message": "âŒ **Contexto de projeto nÃ£o encontrado**\nğŸ”§ **Criando automaticamente...**"
    },
    "invalid_project_name": {
      "action": "show validation error",
      "message": "âŒ **Nome de projeto invÃ¡lido**\nâœ… **Use:** letras, nÃºmeros, hÃ­fens apenas"
    },
    "invalid_date_format": {
      "action": "show validation error",
      "message": "âŒ **Formato de data invÃ¡lido**\nâœ… **Use:** DD-MM ou YYYY-MM-DD\nğŸ’¡ **Exemplo:** 10-06 ou 2025-06-10"
    },
    "permission_error": {
      "action": "show permission error",
      "message": "âŒ **Erro de permissÃ£o ao acessar projeto**\nğŸ” **Verificar:** permissÃµes da pasta .zoe/"
    },
    "no_historical_progress": {
      "action": "continue without history",
      "message": "â„¹ï¸ **Nenhum progresso histÃ³rico encontrado**\nğŸ†• **Iniciando nova sessÃ£o sem contexto anterior**"
    }
  }
} 